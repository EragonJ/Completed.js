!function(){if("undefined"==typeof window.Completed){var a={},b={};a.module={add:function(a,c){b[a]||(b[a]=c)},get:function(a){return b[a]}},window.Completed=a}}(),function(){var a={13:"ENTER",27:"ESC",32:"SPACE",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"};Completed.module.add("KeyMap",a)}(),function(){var a=function(a){return document.querySelectorAll(a)};a.removeClass=function(b,c){var d;d="string"==typeof b?a(b):[b];for(var e=0,f=d.length;f>e;e++)if(a.hasClass(d[e],c)){var g=new RegExp("\\s*"+c+"\\s*","g"),h=d[e].className.replace(g," ");d[e].className=h}},a.addClass=function(b,c){var d;d="string"==typeof b?a(b):[b];for(var e=0,f=d.length;f>e;e++)a.hasClass(d[e],c)||(d[e].className+=" "+c)},a.hasClass=function(b,c){var d;if(d="string"==typeof b?a(b)[0]:[b][0]){var e=new RegExp(c);return e.test(d.className)}return!1},a.siblings=function(b,c){for(var d=a(b),e=a(c)[0],f=null,g=null,h=0,i=d.length;i>h;h++)d[h]==e&&("undefined"!=typeof d[h-1]&&(g=d[h-1]),"undefined"!=typeof d[h+1]&&(f=d[h+1]));return{next:f,prev:g}},a.trim=function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},a.on=function(b,c,d){var e;e="string"==typeof c?a(c):[c];for(var f=0,g=e.length;g>f;f++)e[f].addEventListener(b,d,!1)},Completed.module.add("$",a)}(),function(){function a(){if(window.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(a){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}throw new Error("This browser does not support XMLHttpRequest.")}var b=function(b,c){var d=a();d.onreadystatechange=function(){if(!(d.readyState<4)){if(200!==d.status)throw new Error(d.statusText);4===d.readyState&&c(d.responseText)}},d.open("GET",b,!0),d.send("")};Completed.module.add("Getter",b)}(),function(){var a={};"undefined"===window.console?["log","warn","debug","info","error"].forEach(function(b){a[b]=function(){}}):a=window.console,Completed.module.add("Console",a)}(),function(){var a=Completed.module.get("Getter"),b=Completed.module.get("KeyMap"),c=Completed.module.get("$");Completed.module.get("Console");var d=function(a,b){b=b||{},this.doms=c(a),this.inputSelectors=a,this.autoCompleteData=b.data||null,this.autoCompleteDataSrc=b.dataSrc||"public/data/autocomplete.json",this.autoCompleteSearchTimer=null,this.autoCompleteSearchDelay=b.delay||10,this.autoCompleteWrapperClass="autocomplete-wrapper",this.autoCompleteListClass="autocomplete-list",this.autoCompleteOpening=!1,this.autoCompleteMatchedData=[],this.AC_MAX_LIST_COUNT=5,this.AC_LIST_OFFSET=30,this.AC_WRAPPER_OFFSET=5,this.init()};d.prototype={init:function(){this.getAutocompleteData(function(){this.createAutocompleteWrapper(),this.bindAutocompleteWrapperMouseEvent(),this.bindInputSearchEvent()})},createAutocompleteWrapper:function(){if(0===c("."+this.autoCompleteWrapperClass).length){var a=document.createElement("div");a.className=this.autoCompleteWrapperClass+" close",c("body")[0].appendChild(a)}},createAutocompleteList:function(){for(var a=document.createDocumentFragment(),b=this.autoCompleteMatchedData,d=0,e=b.length;e>d;d++){var f=b[d],g=document.createElement("div");g.innerHTML=f,g.className=this.autoCompleteListClass,0===d&&(g.className+=" selected"),a.appendChild(g)}c("."+this.autoCompleteWrapperClass)[0].appendChild(a)},removeAutocompleteList:function(){for(var a=c("."+this.autoCompleteWrapperClass)[0];a.firstChild;)a.removeChild(a.firstChild)},showAutocompleteWrapper:function(){this.autoCompleteOpening||c.removeClass("."+this.autoCompleteWrapperClass,"close"),this.autoCompleteOpening=!0},hideAutocompleteWrapper:function(){this.autoCompleteOpening&&c.addClass("."+this.autoCompleteWrapperClass,"close"),this.autoCompleteOpening=!1},repositionAutocompleteWrapper:function(a){var b=a.getBoundingClientRect(),d=c("."+this.autoCompleteWrapperClass)[0];d.style.top=parseInt(b.top+b.height+this.AC_WRAPPER_OFFSET,10)+"px",d.style.left=parseInt(b.left,10)+"px"},scrollAutocompleteWrapper:function(a){var b=c("."+this.autoCompleteWrapperClass)[0],d=c("."+this.autoCompleteListClass+".selected")[0];d.offsetTop>=b.scrollTop&&d.offsetTop<=b.scrollTop+(this.AC_MAX_LIST_COUNT-1)*this.AC_LIST_OFFSET||("UP"===a?b.scrollTop-=this.AC_LIST_OFFSET:b.scrollTop+=this.AC_LIST_OFFSET)},getAutocompleteData:function(b){var c=this;null===this.autoCompleteData?a(this.autoCompleteDataSrc,function(a){var d=JSON.parse(a);c.autoCompleteData=d.autoCompleteData,b.call(c)}):b.call(c)},bindAutocompleteWrapperMouseEvent:function(){var a=this,b=c("."+this.autoCompleteWrapperClass)[0];c.on("mousedown",b,function(b){a.isAutocompleteList(b.target)&&(a.selectMatchedData(),a.hideAutocompleteWrapper())}),c.on("mouseover",b,function(b){c.removeClass("."+a.autoCompleteListClass,"selected"),a.isAutocompleteList(b.target)&&c.addClass(b.target,"selected")})},bindInputSearchEvent:function(){for(var a=this,d=0,e=this.doms.length;e>d;d++){var f=this.doms[d];c.on("keydown",f,function(d){"ENTER"===b[d.which]?(a.selectMatchedData(),a.hideAutocompleteWrapper()):"UP"===b[d.which]?(a.moveAutocompleteSelector("UP"),d.preventDefault()):"DOWN"===b[d.which]?(a.moveAutocompleteSelector("DOWN"),d.preventDefault()):"ESC"===b[d.which]?(a.hideAutocompleteWrapper(),d.preventDefault()):(window.clearTimeout(a.autoCompleteSearchTimer),a.autoCompleteSearchTimer=window.setTimeout(function(){var b=c.trim(f.value);a.autoCompleteMatchedData=a.searchPossibleMatches(b),a.isMatched()?(a.removeAutocompleteList(),a.createAutocompleteList(),a.repositionAutocompleteWrapper(f),a.showAutocompleteWrapper()):a.hideAutocompleteWrapper()},a.autoCompleteSearchDelay))}),c.on("focus",f,function(){a.isMatched()&&(a.repositionAutocompleteWrapper(f),a.showAutocompleteWrapper())}),c.on("blur",f,function(){a.hideAutocompleteWrapper()})}},searchPossibleMatches:function(a){if(0===a.length)return[];for(var b=[],c=new RegExp("^"+a,"i"),d=0,e=this.autoCompleteData.length;e>d;d++){var f=this.autoCompleteData[d];c.test(f)&&b.push(f)}return b},moveAutocompleteSelector:function(a){var b=c.siblings("."+this.autoCompleteListClass,"."+this.autoCompleteListClass+".selected");(b.prev&&"UP"===a||b.next&&"DOWN"===a)&&(c.removeClass("."+this.autoCompleteListClass,"selected"),"UP"===a?c.addClass(b.prev,"selected"):c.addClass(b.next,"selected"),this.scrollAutocompleteWrapper(a))},selectMatchedData:function(){if(this.autoCompleteOpening){var a=c(this.inputSelectors+":focus")[0],b=c("."+this.autoCompleteListClass+".selected")[0],d=b.innerHTML;a.value=d}},isMatched:function(){return this.autoCompleteMatchedData.length>0},isAutocompleteList:function(a){return a&&c.hasClass(a,this.autoCompleteListClass)}},window.Completed=d}();